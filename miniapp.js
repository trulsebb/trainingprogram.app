"use strict";const m=[{group:"Squat",movements:[{mid:0,label:"Squats"},{mid:1,label:"Highbar squats"},{mid:2,label:"Paused squats"},{mid:3,label:"Front squats"},{mid:4,label:"SSB squats"},{mid:21,label:"Highbar paused squats"}]},{group:"Bench",movements:[{mid:5,label:"Bench press"},{mid:6,label:"Medium grip bench press"},{mid:7,label:"Close grip bench press"},{mid:8,label:"Larsen press"},{mid:9,label:"Close grip Larsen press"},{mid:10,label:"Medium grip Larsen pin press"},{mid:20,label:"Incline press"},{mid:22,label:"Log press"},{mid:23,label:"Floor press"},{mid:29,label:"Long Pause Bench"}]},{group:"Deadlift",movements:[{mid:11,label:"Deadlifts"},{mid:12,label:"Deficit deadlifts"},{mid:13,label:"Snatch grip deadlifts"},{mid:14,label:"Block pulls"},{mid:25,label:"Sumo deadlifts"},{mid:30,label:"Romanian deadlifts"}]},{group:"Other",movements:[{mid:15,label:"Sealrow"},{mid:16,label:"Standing row"},{mid:17,label:"Pullups"},{mid:18,label:"Weighted pullups"},{mid:19,label:"Weighted dips"},{mid:24,label:"Bulgarian split squats"},{mid:26,label:"Leg press"},{mid:27,label:"Deficit push-ups"},{mid:28,label:"Face Pulls"},{mid:31,label:"Lat Pulldown"},{mid:32,label:"Hyperextensions"},{mid:33,label:"Curls"}]}],l=[{id:0,title:"Basic training program",shareString:"ko0408084448k-2+48484A0c4448s-2+4c448-23Wkk484g04w8084448k-2+48484A0c4448s-2+4c448-23Wkk484g0488084448k-2+48484A0c4448s-2+4c448-23Wkk484g04A8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04I8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04E8084448k-2+48484A0c4448s-2+4c448-23Wkk484g"},{id:1,title:"Swiss program",shareString:"kk0808084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21i8084448w-2+48484w0c4448E-2+4c448-23Wkk484g08k8084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21m8084448k-2+48484A0c4448s-2+4c448-23Wkk484g08I8084448k-2+48484A0c4448s-2+4c448-23Wkk484gs8084448w-2+48484w0c4448E-2+4c448-23Wkk484g08-21u8084448k-2+48484A0c4448s-2+4c448-23Wkk484g-21q8084448k-2+48484w0c4448s-2+4c448-23Wkk484g08-21C8084448w-2+48484w0c4448E-2+4c448-23Wkk484g-21u8084448w-2+48484w0c4448E-2+4c448-23Wkk484g"},{id:2,title:"Oldschool linear",shareString:"oo04040c4448E-2+4c448-23Kgk448E-2+404w40c4448E-2+4c448-23Kgk448E-2+404840c4448E-2+4c448-23Kgk448E-2+404A40c4448E-2+4c448-23Kgk448E-2+404I40c4448E-2+4c448-23Kgk448E-2+404E40c4448E-2+4c448-23Kgk448E-2+4"},{id:3,title:"Advanzed program",shareString:"ko0408084448k-2+48484A0c4448s-2+4c448-23Wkk484g04wk088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S0488084448k-2+48484A0c4448s-2+4c448-23Wkk484g04Ak088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S04I8084448k-2+48484A0c4448s-2+4c448-23Wkk484g04Ek088484Ac484-25a088484Ac484-25u088484Ac484-25O088484Ac484-268088484Ac484-23S"},{id:4,title:"Powerbuilder",shareString:"ks0k08084484c8484s0c4484w8484sk484ck8084484c8484s0c4484w8484sk484c-21G40c4484w8484sk484c-21K40c4484E8484wk484c-21O40c4484E8484sk484c000kI80c448448484Ak484E088484Ec484-24w-21u40c4484k8484sk484cc40c4484k8484sk484c-22040c4484E8484wk484c-21640c8484Eg4840k484c000o-21S8084484c8484s0c4484k8484wk484c88084484c8484s0c4484k8484wk484c-21e40c8484Cg4840k484c-21G40c4484k8484sk484c-22840c8484Ec484-23Sk484c-21O40c4484E8484sk484c0k-21W8084484k8484w0c4484w8484sk484c-21q40c4484w8484sk484c-22040c4484E8484wk484c-21i40c4484E8484wk484c-2164088484wk484c00"}],u=9999,j=new Map(m.map(e=>e.movements.map(e=>[e.mid,e.label])).flat()),o=(e,t)=>e*(36/(37-t));var a;a=1;const V=n=>t=>e=>o(n,t+(11-e-a)),y=e=>{e=2.5*Math.round(e/2.5);return 0<e?e:""},r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),n=e=>{if(0==e)return 0;let t="";var n=e<0?"+":"";let a=(4*Math.abs(e)).toFixed();for(;0<a;)t=r[a%62]+t,a=(a-a%62)/62;return n+t},i=e=>{var t="+"===e[0];const n="+"===e[0]?e.slice(1):e;e=n.split("").map(t=>r.findIndex(e=>e==t)).reverse().map((e,t)=>e*62**t).reduce((e,t)=>e+t)/4;return t?-1*e:e};class g{static latestId=1e3;static resetId(){this.latestId=1e3}static getUniqueId(){return this.latestId++}}const h=()=>[...Array(localStorage.length).keys()].map(e=>localStorage.key(e)),v=(e,t)=>n([e,t].join("")),b=()=>h().filter(e=>e.match(/^\d{4}$/g)).map(e=>{localStorage.removeItem(e)}),s=()=>h().filter(e=>e.match(/^\d{4}$/g)).map(e=>v(e,localStorage.getItem(e))).join("-"),T=e=>{const t=i(e).toString(10);return[t.slice(0,4),t.slice(4)]},$=e=>e.split("-").map(e=>T(e)),d=()=>{var e=(new Date).toISOString().slice(0,10),t=E(u)(0);const n=s();1<n.split("-").length&&localStorage.setItem(`progress-${t}-`+e,s())},c=e=>{d(),b(),$(e).map(e=>k(e[0])(e[1]))},k=t=>e=>localStorage.setItem(t,e),E=t=>e=>localStorage.getItem(t)?localStorage.getItem(t):e,F=()=>{let t=0;for(;t=Math.floor(900*Math.random()+100),0<h().filter(e=>e.match(new RegExp("^program-"+t,"g"))).length;);return t},f=(e,t)=>{var n=F();return localStorage.setItem(`program-${n}-`+e,t),n},K=()=>{return h().filter(e=>e.match(/^program-/g)).map(e=>({id:Number(e.match(/^program-(\d+)/)[1]),title:e.match(/^program-\d+-(.+)/)[1],shareString:localStorage.getItem(e)}))},e=()=>[...l,...K()],p=t=>e().find(e=>e.id==t)??p(0),w=(e,t,n)=>{const a=document.createElement(e);return a.classList.add(...t),"string"==typeof n?a.textContent=n:Array.isArray(n)?a.append(...n):"object"==typeof n&&a.appendChild(n),a},S=(t,n=null)=>{document.addEventListener("mouseup",e=>{t.contains(e.target)||null!==n&&n.contains(e.target)||(t.hidden=!0)})},J=e=>w("tr",[],e.map(e=>w("td",[],e))),U=e=>w("tr",[],e.map(e=>w("th",[],e))),H=e=>{const t=document.createElement("input");return t.id=g.getUniqueId(),t.onchange=()=>k(t.id)(t.checked?1:0),t.setAttribute("type","checkBox"),t.checked="1"===E(t.id)(0),t.setAttribute("aria-label",e),t.setAttribute("title",e),t},C=(e,t,n,a,r)=>{const i=document.createElement("input");return t<100&&1==n&&i.classList.add("smallInput"),i.id=g.getUniqueId(),i.onchange=()=>k(i.id)(i.value),i.setAttribute("type","number"),i.value=E(i.id)(a),i.min=e,i.max=t,i.step=n,i.setAttribute("aria-label",r),i.setAttribute("title",r),i},A=(e,t,n=!1)=>{const a=document.createElement("input");return n&&a.classList.add("alwaysDisabled"),a.setAttribute("type","text"),a.value=e,a.disabled=!0,a.setAttribute("aria-label",t),a.setAttribute("title",t),a};class L{static shareContainer=null;static getShareButton=()=>{const e=w("button",["loadSaveButton"],"💾 Load/save progress");return e.onclick=()=>{this.shareContainer.dispatchEvent(new Event("toggleVisibility")),this.shareContainer.hidden=!this.shareContainer.hidden},e};static initShareContainer=()=>{const o=w("div",["shareLinkContainer"]);o.hidden=!0,o.addEventListener("toggleVisibility",()=>{for(;o.firstChild;)o.removeChild(o.firstChild);var e=E(u)(0);const t=new RegExp("progress-"+e,"g"),n=(o.append(...h().filter(e=>e.match(t)).sort().map(e=>{var t=e.substring(e.length-10);const n=w("div",["shareStringContainer"],w("label",["shareStringLabel"],t)),a=w("button",["clearButton"],"✖"),r=(a.onclick=()=>{localStorage.removeItem(e),o.dispatchEvent(new Event("toggleVisibility"))},w("input",["presentedlink"],"")),i=(r.type="text",r.value=localStorage.getItem(e),w("button",[],"Copy")),s=(i.onclick=()=>{r.select(),document.execCommand("copy")},w("button",[],"Restore"));return s.onclick=()=>{c(r.value),q.renderProgram()},n.append(a,r,i,s),n})),w("div",["shareStringContainer"])),a=w("button",[],"Save current"),r=(a.onclick=()=>{d(),o.dispatchEvent(new Event("toggleVisibility"))},w("button",["closebutton"],"▲ ▲ ▲"));r.onclick=()=>{o.hidden=!o.hidden},n.append(a),o.append(n,r)}),this.shareContainer=o}}const G=e=>{const t=w("h2",["restDayText"],"Rest day");return t.hidden=0<e.length,t};class I{static programSettingsContainer=w("div",["programSettingsContainer"]);static startDateOption=null;static toggleVisibility=()=>{this.programSettingsContainer.hidden=!this.programSettingsContainer.hidden};static getProgramSettingsButton=()=>{const e=w("button",["settingsMenuButton"],"⚙");return e.onclick=()=>{this.toggleVisibility()},e};static movementsMaxMap=new Map;static movementsTitleMap=new Map(m.map(e=>e.movements.map(e=>[e.mid,e.label])).flat());static movementsMaxInputMap=new Map;static initProgramSettingsContainer=(e,t,n)=>{this.movementsMaxInputMap=new Map,this.movementsMaxMap=new Map;const a=w("div",["programSettingsContainer"]),r=(a.id="programSettings",[...new Set(e.days.map(e=>e.filter(e=>e.sets.some(e=>null!==e.rpe(1)&&null!==e.reps(1))).map(e=>e.movementId)).flat())]),i=[...new Set(e.days.map(e=>e.filter(e=>e.sets.every(e=>null===e.rpe(1)||null===e.reps(1))).map(e=>e.movementId)).flat())],s=(L.initShareContainer(),w("button",["clearButton"],"✖ Reset Progress"));if(s.onclick=()=>{var e=E(u)();b(),k(u)(e),q.renderProgram()},this.startDateOption=(e=>{const t=document.createElement("input");t.id=g.getUniqueId(),t.onchange=()=>{0<t.valueAsNumber?k(t.id)(t.valueAsNumber/1e5):localStorage.removeItem(t.id)},t.setAttribute("type","date");e=1e5*E(t.id)(e);return e&&(t.valueAsNumber=e),t})(),this.startDateOption.addEventListener("change",()=>{const n=0<this.startDateOption.valueAsNumber?new Date(this.startDateOption.value):null,a=(new Date).toJSON().substring(0,10);document.querySelectorAll(".dayLegend").forEach((e,t)=>{n instanceof Date?(e.hidden=!1,e.textContent=n.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"}),n.toJSON().substring(0,10)==a&&e.parentElement.parentElement.scrollIntoView({behavior:"smooth"}),n.setDate(n.getDate()+1)):e.hidden=!0})}),a.append(w("label",[],["Start date:",this.startDateOption])),a.append(...[{title:"Required e1RMs",movs:i},{title:"Optional e1RMs",movs:r}].map(e=>0<e.movs.length?w("table",["settingsTable"],[w("caption",[],e.title+":"),U(["Movment","e1RM"]),...e.movs.map(e=>{const t=C(75,1e3,2.5);return t.addEventListener("change",()=>{this.movementsMaxMap.set(e,t.value)}),this.movementsMaxInputMap.set(e,t),this.movementsMaxMap.set(e,t.value),J([this.movementsTitleMap.get(e),t])})]):null).filter(e=>null!==e),L.getShareButton(),L.shareContainer,s),t){a.append(P.getProgramEditorButton());const l=new URL(window.location.origin),d=(l.searchParams.set("t",e.title),l.searchParams.set("p",n),l.searchParams.set("r",h().filter(e=>e.match(/^\d{4}$/g)).filter(e=>e!=u).map(e=>v(e,localStorage.getItem(e))).join("-")),w("input",["presentedlink"],"")),c=(d.type="text",d.value=l.href,w("button",[],"Copy")),p=(c.onclick=()=>{d.select(),document.execCommand("copy")},w("div",["shareStringContainer"],[d,c])),m=(p.hidden=!0,w("button",[],"🌍Share program"));m.onclick=()=>{p.hidden=!p.hidden},a.append(m,p)}0!=i.length&&![...this.movementsMaxInputMap.keys()].filter(e=>i.includes(e)).every(e=>0<this.movementsMaxInputMap.get(e).value)||(a.hidden=!0);const o=w("button",["closebutton"],"▲ ▲ ▲");o.onclick=this.toggleVisibility,a.append(o),this.programSettingsContainer=a}}class P{static programEditorContainer=null;static toggleVisibility=()=>{this.programEditorContainer.hidden=!this.programEditorContainer.hidden,window.scrollTo({top:0,behavior:"smooth"})};static getNewProgramButton=()=>{const e=w("button",["createNewProgramButton"],"Create new program");return e.onclick=()=>{d(),b(),q.renderProgram({title:"New program",shareString:"ks00000000000000"},!1)},e};static getProgramEditorButton=()=>{const e=w("button",[],"📝Edit Program");return e.onclick=()=>{this.toggleVisibility(),I.programSettingsContainer.hidden=!0},e};static initProgramEditorContainer=n=>{const a=Y(n.title,n.shareString),e=w("div",["programEditorContainer"]),o=(e,t,n)=>{n.value="text"===n.type?e[t]:Number(e[t]),n.addEventListener("change",()=>{e[t]=n.value})},t=w("button",["closebutton"],"▲ ▲ ▲"),r=(t.onclick=this.toggleVisibility,w("input",[])),i=(r.setAttribute("type","text"),o(a,"title",r),r.value=a.title,w("input",[])),s=(i.setAttribute("type","number"),i.addEventListener("change",()=>c.dispatchEvent(new Event("render"))),o(a,"numberOfIterations",i),w("input",[])),l=(s.setAttribute("type","number"),s.onchange=()=>{s.value<=a.days.length?a.days=a.days.slice(0,s.value):s.value<=10&&a.days.push(...Array(s.value-a.days.length).fill([])),c.dispatchEvent(new Event("render"))},s.value=a.days.length,e.append(t,w("div",["editorFieldBox"],[w("label",[],"Title"),r]),w("div",["editorFieldBox"],[w("label",[],"Number of iterations/weeks"),i]),w("div",["editorFieldBox"],[w("label",[],"Number of days per week"),s])),new Map([[x,{optionLabel:"None",nrOfParams:0}],[B,{optionLabel:"Linear",nrOfParams:2}],[O,{optionLabel:"Constant",nrOfParams:1}],[D,{optionLabel:"Steps",nrOfParams:a.numberOfIterations}]])),d=(e,t,n=!1)=>{const a=w("button",["editLegendButton"],"✖"),r=(a.onclick=n?()=>{e[t]=[],c.dispatchEvent(new Event("render"))}:()=>{e.splice(t,1),c.dispatchEvent(new Event("render"))},w("button",["editLegendButton"],"▲")),i=(0<t&&1<e.length?r.onclick=()=>{e.splice(t-1,0,e.splice(t,1)[0]),c.dispatchEvent(new Event("render"))}:r.disabled=!0,w("button",["editLegendButton"],"▼"));if(e.length-1>t?i.onclick=()=>{e.splice(t+1,0,e.splice(t,1)[0]),c.dispatchEvent(new Event("render"))}:i.disabled=!0,n)return w("div",["editorLegendButtonList"],[r,i,a]);const s=w("button",["editLegendButton"],"⧉");return s.onclick=()=>{e.splice(t,0,JSON.parse(JSON.stringify(e[t]))),c.dispatchEvent(new Event("render"))},w("div",["editorLegendButtonList"],[s,r,i,a])},c=w("div",["allDaysContainer"]),p=(c.addEventListener("render",e=>{for(;c.firstChild;)c.removeChild(c.firstChild);c.append(...a.days.map((i,e)=>{const t=w("div",["dayEditContainer"]);var n=w("div",["innerDayEdit"],[((a,r)=>{const e=w("span",["copyDayList"],a.map((e,t)=>{const n=w("button",["copyDayButton","editorButton"],"Day "+(t+1));return n.onclick=()=>{a[r]=JSON.parse(JSON.stringify(e)),c.dispatchEvent(new Event("render"))},t==r&&(n.disabled=!0),n})),t=(e.hidden=!0,w("button",["showCopyDayButton"],"Copy from a different day"));return t.onclick=()=>{e.hidden=!e.hidden},w("div",["fullWidth"],[t,e])})(a.days,e),...i.map((n,e)=>{const t=w("div",["movementEditContainer"]);var a=n.sets.map((s,e)=>{const t=w("div",["setContainer"]);return t.append(w("div",["editorLegend"],[w("span",["editorLegendTitle"],"Set "+(e+1)),d(n.sets,e)]),w("div",["innerSetEdit"],[...Object.entries(s).filter(([,e])=>e.type!=x).map(([e,a])=>{const t=w("div",["progressionContainer"]),r=w("select",["progressionSelect"]),n=w("div",["progressionEditor"]),i=(l.forEach((e,t)=>{const n=w("option",[],e.optionLabel);(n.value=t)===a.type&&(n.selected=!0),r.append(n)}),o(a,"type",r),r.addEventListener("change",()=>{for(;n.firstChild;)n.removeChild(n.firstChild);const e=new Map([[x,[]],[B,["initial","change"]],[O,["value"]],[D,Array(5).fill().map((e,t)=>"step "+(t+1))]]);n.append(((a,r)=>{const e=w("div",["paramsContainer"]),t=Array(r.length).fill();var n=t.map((e,t)=>{const n=w("input",["paramInput"]);return n.setAttribute("type","number"),n.min=-1e3,n.max=1e3,n.step=.25,o(a,t,n),w("div",["paramBox"],[w("label",[],r[t]),n])});return e.append(...n),e})(a.params,e.get(Number(r.value))))}),r.dispatchEvent(new Event("change")),w("button",["clearButton","editorButton"],"✖"));return i.onclick=()=>{delete s[e],c.dispatchEvent(new Event("render"))},t.append(w("label",["progressionLabel"],z[e]),r,n,i),t}),w("div",["setParamButtonList"],Object.keys(W).filter(e=>!Object.keys(s).includes(e)).map(e=>{{var t=s,n=e;const a=w("button",["addParamButton"],z[n]);return a.onclick=()=>{t[n]={type:O,params:[]},c.dispatchEvent(new Event("render"))},a}}))])),t}),r=(n=>{const e=w("select",["dumbmovementselect"]);var t=m.map(e=>{const t=w("optgroup",[],e.movements.map(e=>{const t=w("option",[],e.label);return t.value=e.mid,e.mid==n&&(t.selected=!0),t}));return t.label=e.group,t});return e.append(...t),e})(n.movementId);return o(n,"movementId",r),t.append(w("div",["editorLegend"],[w("span",["editorLegendTitle"],"Movement "+(e+1)),d(i,e)]),w("div",["innerMovementEdit"],[r,...a,(e=>{const t=w("button",["addSetButton"],"Add set");return t.onclick=()=>{e.sets.push({}),c.dispatchEvent(new Event("render"))},t})(n)])),t}),G(i),(e=>{const t=w("button",["addMovementButton"],"Add movement");return t.onclick=()=>{e.push({movementId:0,sets:[{}]}),c.dispatchEvent(new Event("render"))},t})(i)]);return t.append(w("div",["editorLegend"],[w("span",["editorLegendTitle"],"Day "+(e+1)),d(a.days,e,!0)]),n),t}))}),c.dispatchEvent(new Event("render")),e.append(c),w("button",[],"Save and render program"));p.onclick=()=>{var e=Q(a),t=`program-${n.id}-`+a.title;localStorage.getItem(t)?localStorage.setItem(t,e):(t=f(a.title,e),k(u)(t)),q.renderProgram({title:a.title,shareString:e})},e.append(p),e.hidden=!a.days.every(e=>0==e.length),this.programEditorContainer=e}}class M{static selectProgramContainer=w("div",["selectProgramContainer"]);static getSelectProgramButton=()=>{const e=w("button",["settingsMenuButton"],"≡");return e.onclick=()=>{this.selectProgramContainer.hidden=!this.selectProgramContainer.hidden},S(this.selectProgramContainer,e),e};static getProgramSelectRow=(e,t=!1)=>{const n=w("div",["programSelectRow"]),a=w("button",["selectProgramButton"],e.title),r=(a.onclick=()=>{d(),b(),k(u)(e.id),q.renderProgram(p(e.id))},w("button",["selectProgramButton"],"✎")),i=(r.onclick=()=>{d(),b(),q.renderProgram(e,!1),P.toggleVisibility(),I.programSettingsContainer.hidden=!0},w("button",["selectProgramButton"],"⧉")),s=(i.onclick=()=>{d(),b(),q.renderProgram({title:"Copy of "+e.title,shareString:e.shareString},!1),P.toggleVisibility(),I.programSettingsContainer.hidden=!0},w("button",["selectProgramButton"],"✖"));return s.onclick=()=>{localStorage.removeItem(`program-${e.id}-`+e.title),n.remove()},t?n.append(a,w("div",["buttonList"],[s,r,i])):n.append(a,w("div",["buttonList"],[i])),n};static initProgramSelect=()=>{const e=w("div",["selectProgramContainer"]);e.hidden=!0,e.append(...l.map(e=>this.getProgramSelectRow(e)),...K().map(e=>this.getProgramSelectRow(e,!0)),P.getNewProgramButton()),this.selectProgramContainer=e}}const B=1,O=2,x=3,D=4,R={linear:(...t)=>e=>t[0]+t[1]*e,constant:(...t)=>e=>t[0],none:()=>e=>null,steps:(...t)=>e=>t[e%t.length]},N=e=>{if("function"==typeof e)return e;if(void 0===e)return R.none();if(null==e)return R.none();if("number"==typeof e)return R.constant(e);if("object"==typeof e){if(e.type===B)return R.linear(...e.params);if(e.type===O)return R.constant(...e.params);if(e.type===x)return R.none();if(e.type===D)return R.steps(...e.params)}return R.none()};const W={reps:1,rpe:2,perc:3,weight:4,repeat:5},z={reps:"Reps",rpe:"RPE",perc:"Percentage",weight:"Weight",repeat:"Repeat"},t=(e,t)=>"object"==typeof t&&t.type!=x?[e,1,t.type,t.params.length,t.params]:[],Q=e=>[e.numberOfIterations,e.days.length,e.days.map(e=>[0,e.length,e.map(e=>[e.movementId,e.sets.length,e.sets.map(e=>[0,Object.values(e).filter(e=>e.type!=x).length,...t(W.reps,e.reps),...t(W.rpe,e.rpe),...t(W.perc,e.perc),...t(W.weight,e.weight),...t(W.repeat,e.repeat)])])])].flat(8).map(e=>n(e)).map(e=>1<e.length?"-"+e.length+e:e).join(""),X=e=>e.split(/(?=-)/g).map(e=>"-"===e[0]?[e.slice(2,2+Number(e[1])),...e.slice(2+Number(e[1])).split("")]:e.split("")).flat(),Y=(e,t)=>{const n=X(t).map(e=>i(e));const a=e=>({type:e[0][0],params:e[0].slice(1).flat()});return{numberOfIterations:n[0],title:e,days:((e,t)=>{const n=[0,0,0,0,0,0,e],a=[];let r=!1,i=!0;return t.forEach(e=>{var t=n.findIndex(e=>0<e);i?(6==t?a.push([e]):5==t?a.at(-1).push([e]):4==t?a.at(-1).at(-1).push([e]):3==t?a.at(-1).at(-1).at(-1).push([e]):2==t?a.at(-1).at(-1).at(-1).at(-1).push([e,[]]):1==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).push([e,[]]):0==t&&a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push([e,[]]),i=!1,r=!0):-1<t&&(r?(n[t-1]=e,r=!1,i=2<t):6==t?a.at(-1).push([e]):5==t?a.at(-1).at(-1).push(e):4==t?a.at(-1).at(-1).at(-1).push(e):3==t?a.at(-1).at(-1).at(-1).at(-1).push(e):2==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).push(e):1==t?a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push(e):0==t&&a.at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).at(-1).push(e),--n[t],n.slice(0,t+1).every(e=>0==e)&&(r=!0,i=!0))}),a})(n[1],n.slice(2)).filter(e=>"object"==typeof e&&0<e.length).map(e=>e.filter(e=>"object"==typeof e&&0<e.length).map(e=>({movementId:e[0],sets:e.slice(1).filter(e=>"object"==typeof e&&0<e.length).map(e=>{const t={};return e.slice(1).map(e=>{e[0]==W.reps?t.reps=a(e.slice(1)):e[0]==W.rpe?t.rpe=a(e.slice(1)):e[0]==W.perc?t.perc=a(e.slice(1)):e[0]==W.weight?t.weight=a(e.slice(1)):e[0]==W.repeat&&(t.repeat=a(e.slice(1)))}),t})})))}};class q{static appContainer=w("div",["appContainer"]);static first=!0;static renderProgram(e,t=!0){for(g.resetId();this.appContainer.firstChild;)this.appContainer.removeChild(this.appContainer.firstChild);window.scrollTo({top:0});let n=p(E(u)(0));"object"==typeof e&&(n=e);var e=Y(n.title,n.shareString),a=(P.initProgramEditorContainer(n),!l.some(e=>e.id===n.id));const r={numberOfIterations:e.numberOfIterations,title:e.title,days:e.days.map(e=>e.map(e=>({movementId:e.movementId,sets:e.sets.map(e=>({reps:N(e.reps),rpe:N(e.rpe),perc:N(e.perc),weight:N(e.weight),repeat:null==e.repeat||void 0===e.repeat?R.constant(1):N(e.repeat)}))})))},i=(I.initProgramSettingsContainer(r,a,n.shareString),w("div",["programContainer"]));if(t){const o=[...Array(r.numberOfIterations).keys()];i.append(...o.map(a=>{var e=w("h2",["weekHeader"],"Week "+(a+1));const t=w("div",["blockContainer","weekelement"],e);return t.id="cycle"+a,t.append(...r.days.map((e,t)=>{{var k=a;const n=w("fieldset",["dayContainer"],[w("h2",["defaultDayLegend"],["Day "+(t+1),w("span",["dayLegend"],"")])]);return n.id=`day${k}-`+t,n.append(...e.map((h,e)=>{const v=[],t=h.sets.map(e=>Array(e.repeat(k)).fill(e)).flat(),b=w("button",["editAllDay"],"✎");return b.addEventListener("click",()=>{b.classList.toggle("pressed")}),w("table",["movementContainer"],[w("caption",["dayCaption"],[j.get(h.movementId),b]),U(["✔","Reps","Weight","%","RPE","e1RM"]),...t.map((n,e)=>{const t=C(0,50,1,n.reps(k),"Reps for set "+(e+1));null!==n.reps(k)&&(t.disabled=!0,t.classList.add("preDisabled"),b.addEventListener("click",()=>{t.disabled=!t.disabled}));var a=A(null!==n.perc(k)?n.perc(k)+"%":null,"Percentage for set "+(e+1),!0);const r=null!==n.perc(k)?A(n.weight(k),"Weight for set "+(e+1)):C(75,1e3,2.5,n.weight(k),"Weight for set "+(e+1)),i=C(1,10,.25,n.rpe(k),"Actual RPE for set "+(e+1)),s=w("div",["overlay"]);var o=w("div",["actualRpeContainer"],[s,i]);i.classList.add("rpeInput"),null===n.rpe(k)&&(i.disabled=!0,i.classList.add("preDisabled"),s.hidden=!0,b.addEventListener("click",()=>{i.disabled=!i.disabled,s.hidden=!s.hidden})),s.addEventListener("click",()=>{p.hidden=!p.hidden});const l=w("input",["rpeRange"]),d=w("button",["resetRpeButton"],"Reset"),c=(d.onclick=()=>{i.value=n.rpe(k),i.dispatchEvent(new Event("change")),l.value=n.rpe(k),l.dispatchEvent(new Event("change"))},w("td",["rpeRangeCell"],[null!==n.rpe(k)?w("span",["goalSpan"],"Goal: "+n.rpe(k)):"",d,l])),p=w("tr",["rpeRangeRow"],c),m=(c.setAttribute("colspan","6"),l.setAttribute("type","range"),l.min=5,l.max=10,l.step=.25,l.value=i.value,p.hidden=!0,S(p,s),l.oninput=()=>{i.value=l.value,i.dispatchEvent(new Event("change"))},l.onchange=()=>{p.hidden=!0},A("...","Estimated 1RM for set "+(e+1),!0));if(null!==n.perc(k)){const g=()=>{var e=I.movementsMaxMap.get(h.movementId)??0,e=v.reduce((e,t)=>Math.max(Number(e),Number(t.value)),e),t="function"==typeof n.perc?n.perc(k):Number(n.perc);r.value=y(t*e/100)};g(),v.map(e=>e.addEventListener("change",g)),I.movementsMaxInputMap.has(h.movementId)&&I.movementsMaxInputMap.get(h.movementId).addEventListener("change",g)}v.push(m);const u=()=>r.value&&t.value&&i.value?V(Number(r.value))(Number(t.value))(Number(i.value)):null;return m.value=y(u()),[t,r,i,l].map(e=>e.addEventListener("input",()=>{m.value=y(u()),m.dispatchEvent(new Event("change"))})),[J([H("Checkbox indicating done set for set "+(e+1)),t,r,a,o,m]),p]}).flat()])}),G(e)),n}})),t}))}const s=w("div",["headerContainer"]);M.initProgramSelect(),s.append(w("div",["titleBar"],[w("div",["selectorDiv"],[M.getSelectProgramButton(),M.selectProgramContainer]),w("h1",["programHeader"],n.title),I.getProgramSettingsButton()]),(r=>{const e=[...Array(r.numberOfIterations).keys()];return w("div",["linkList"],e.map(n=>{const e=w("div",["tightdiv","weekelement"]),t=w("button",["cyclelink"],"Week "+(n+1)),a=w("div",["dayButtonList"]);return a.append(...[...Array(r.days.length).keys()].map(e=>{const t=w("button",["dayButton"],"Day "+(e+1));return t.onclick=()=>{document.querySelector(`#day${n}-`+e).scrollIntoView({behavior:"smooth"}),a.hidden=!0},t})),a.hidden=!0,S(a),e.append(t,a),t.onclick=()=>{a.hidden=!a.hidden},e}))})(r),I.programSettingsContainer),this.appContainer.append(s,P.programEditorContainer,i),this.first&&(document.body.append(this.appContainer),this.first=!1),I.startDateOption.dispatchEvent(new Event("change"))}}window.addEventListener("DOMContentLoaded",async()=>{const e=new URLSearchParams(window.location.search);var t,n,a;e.has("s")?(t=Number(e.get("s")),window.history.replaceState({},document.title,"/"),d(),b(),k(u)(t),e.has("r")&&c(e.get("r")),q.renderProgram()):e.has("t")&&e.has("p")?(t=e.get("t").substring(0,20),n=e.get("p"),window.history.replaceState({},document.title,"/"),d(),b(),a=f(t,n),k(u)(a),e.has("r")&&c(e.get("r")),q.renderProgram({title:t,shareString:n})):(void 0===E(u)()&&k(u)(0),e.has("r")&&c(e.get("r")),q.renderProgram())});